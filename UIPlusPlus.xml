<?xml version="1.0" encoding="utf-8"?>
<UIpp Title="DGDSI UGA" Icon="UI++2_UGA.ico" Color="#444444">
	<Actions>

<!--  START MAIN THREAD   -->
		<Action Type="DefaultValues" ValueTypes="Asset,Net,TPM"/>
		<ActionGroup Name="MAIN THREAD">

<!-- USER AUTH -->
		<Action Type="UserAuth" Title="Authentification" Domain="labloic.local" GetGroups="True" MaxRetryCount="5" DisableCancel="True" Group="Admins du domaine" >
			<Field Name="Username" Prompt="Veuillez respecter le schéma suivante" Hint="admin-xxx" RegEx="admin-[A-Za-z0-9]+"/>
			<Field Name="Password" Prompt="Mot de passe" Hint="Mot de passe du compte admin-xxx"/>
			<!--<Field Name="Domain" List="labloic.local" AutoComplete="true"/>-->
		</Action>

<!-- STARTUP SCREEN -->
		<Action Type="Info" Name="Startup" Title="Bienvenue %XAuthenticatedUserDisplayName% !" Image="topbanner.png" ShowCancel="False" Timeout="0" TimeoutAction="Continue">
			<![CDATA[UGA OS Deployment is now <b>interactive</b> and customized!<br><br>
				<b>Modèle :</b> %XHWModel%<br>
				<b>Numéro de série :</b> %XHWSerialNumber%<br>
				<b>Adresse IP :</b> %XIPAddress%<br>
				<b>Puce TPM activé ? :</b> %XTPMEnabled%<br>
				<b>Secure Boot activé ? :</b> %XSystemSecureBoot%<br>
			]]>
		</Action>	

<!-- SET PREFERRED TASK SEQUENCE DEPLOYMENT ID AND SERVICE CODE -->
		<Action Type="TSVar" Variable="TS_List">"Windows 11,Windows 11 - TEST"</Action>
		<Action Type="TSVar" Variable="TS_Codes">"LL12000F,LL120012"</Action>
		<Action Type="TSVar" Variable="ITServiceCode">"0000"</Action>
		<Action Type="TSVar" Variable="SelectedTS">"LL12000F"</Action>
		<Action Type="TSVar" Name="SMSTSPreferredAdvertID">"LL12000F"</Action>

<!--  SITE SELECTION SCREEN WITH SITE PRE-LOADED FROM IP ADDRESS ABOVE -->
		<Action Type="Input" Name="SiteSelectionScreen" Title="Input selection" Timeout="30">
			<InputChoice Variable="SelectedTS" Question="Select Image:" Required="True">
				<ChoiceList OptionList="%TS_List%" AlternateValueList="%TS_Codes%"/>
			</InputChoice>
		</Action>
		
		<Action Type="Switch" OnValue='%SelectedTS%' DontEval="False">
			<Case RegEx="^Windows 11">
				<Variable Name="SMSTSPreferredAdvertID">"LL12000F"</Variable>
			</Case>
			<Case RegEx="^Windows 11 - TEST">
				<Variable Name="SMSTSPreferredAdvertID">"LL120012"</Variable>
			</Case>
		</Action>

		<Action Type="Input" Name="ClientSetupInput" Title="Client Setup" ShowBack="True">
			<TextInput Prompt="Computer Name" Hint="Enter the name for this system" RegEx="[^\&quot;/\\\[\]:;\|=,\+\*\?&gt;&lt;]{3,15}" Variable="ZZComputerName" Question="Name for this system" Default="%_SMSTSMachineName%"/>
			<ChoiceInput Variable="ZZBuildType" Question="Please select the build type for this system" Required="True" Default="2009">
				<Choice Option="Windows 10 1909" Value="1909" />
				<Choice Option="Windows 10 20H2" Value="2009" />
			</ChoiceInput>
			<CheckboxInput Variable="ZZExtraLogging" Question="Enable extra logging" CheckedValue="True" UncheckedValue="False" Default="True"/>
		</Action>
		<Action Type="TSVar" Name="OSDComputerName" >"%ZZComputerName%"</Action>
		<Action Type="TSVar" Name="OSDBuildType" >"%ZZBuildType%"</Action>
		<Action Type="Input" Name="LocationChoice" Title="System Location">
			<ChoiceInput Variable="MyLocation" Question="Please choose a final location for this computer" Required="True" Default="Minneapolis" >
				<Choice Option="Minneapolis1" Value="Minneapolis1"/>
				<Choice Option="Ottawa1" Value="Ottawa1"/>
				<Choice Option="Woodbury1" Value="Woodbury1"/>
				<Choice Option="Grand Rapids1" Value="GrandRapids1" />
				<Choice Option="Phoenix1" Value="Phoenix1"/>
				<Choice Option="Minneapolis2" Value="Minneapolis2"/>
				<Choice Option="Ottawa2" Value="Ottawa2"/>
				<Choice Option="Woodbury2" Value="Woodbury2"/>
				<Choice Option="Grand Rapids2" Value="GrandRapids2" />
				<Choice Option="Phoenix2" Value="Phoenix2"/>
				<Choice Option="Minneapolis3" Value="Minneapolis3"/>
				<Choice Option="Ottawa3" Value="Ottawa3"/>
				<Choice Option="Woodbury3" Value="Woodbury3"/>
				<Choice Option="Grand Rapids3" Value="GrandRapids3" />
				<Choice Option="Phoenix3" Value="Phoenix3"/>
				<Choice Option="Minneapolis4" Value="Minneapolis4"/>
				<Choice Option="Ottawa4" Value="Ottawa4"/>
				<Choice Option="Woodbury4" Value="Woodbury4"/>
				<Choice Option="Grand Rapids4" Value="GrandRapids4" />
				<Choice Option="Phoenix4" Value="Phoenix4"/>
				<Choice Option="Minneapolis5" Value="Minneapolis5"/>
				<Choice Option="Ottawa5" Value="Ottawa5"/>
				<Choice Option="Woodbury5" Value="Woodbury5"/>
				<Choice Option="Grand Rapids5" Value="GrandRapids5" />
				<Choice Option="Phoenix5" Value="Phoenix5"/>
			</ChoiceInput>
		</Action>
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Minneapolis1"'>"LDAP://OU=Minneapolis,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Ottawa1"'>"LDAP://OU=Ottawa,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Woodbury1"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "GrandRapids1"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Phoenix1"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action>
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Minneapolis2"'>"LDAP://OU=Minneapolis,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Ottawa2"'>"LDAP://OU=Ottawa,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Woodbury2"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "GrandRapids2"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Phoenix2"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Minneapolis3"'>"LDAP://OU=Minneapolis,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Ottawa3"'>"LDAP://OU=Ottawa,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Woodbury3"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "GrandRapids3"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Phoenix3"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Minneapolis4"'>"LDAP://OU=Minneapolis,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Ottawa4"'>"LDAP://OU=Ottawa,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Woodbury4"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "GrandRapids4"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Phoenix4"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Minneapolis5"'>"LDAP://OU=Minneapolis,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Ottawa5"'>"LDAP://OU=Ottawa,OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Woodbury5"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "GrandRapids5"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 
		<Action Type="TSVar" Name="OSDDomainOUName" Condition='"%MyLocation%" = "Phoenix5"'>"LDAP://OU=Workstations,OU=RECAST,DC=corp,DC=viamonstra,DC=com"'</Action> 

<!--  ****************  CHANGE DEFAULT LOCALIZATION SETTINGS ****************** -->
		<ActionGroup Name="Customization" Condition='"%ChangeDefaults%" = "True"'>
			
	<!--   CHANGE DEFAULT LANGUAGE   -->
			<Action Type="Input" Name="myInput" Title="Please answer the following" ShowBack="True">
				<InputChoice Variable="UILanguage" AlternateVariable="OSDWindowsSettingsUILanguage" Question="Windows Language:" Required="True">
					<ChoiceList OptionList="%LangList%" AlternateValueList="%LangCodes%"/>
				</InputChoice>
				
	<!--   CHANGE DEFAULT KEYBOARD - this changes the locale for that input too  -->
				<InputChoice Variable="KeyboardLayout" Question="Keyboard Layout:" Required="True">
					<ChoiceList OptionList="%KeybList%" AlternateValueList="%KeybCodes%"/>
				</InputChoice>			
			</Action>
		</ActionGroup>	

<!-- SUMMARY WINDOW -->
		<Action Type="Info" Name="Summary" Title="Summary" ShowBack="False" > 
			<![CDATA[Values based on previous selections: <br><hr>
				<b>Nom de l'ordinateur :</b>  %OSDComputerName%<br>
				<b>Domain Name :</b>  %OSDDomainName%<br>
				<b>Windows Language :</b>  %UILanguage%<br>
				<b>Disposition de clavier :</b>  %KeyboardLayout%<br>
				<b>Adresse IP :</b> %XIPAddress%<br>
			]]>
		</Action> 
		</ActionGroup>
	</Actions>
</UIpp>